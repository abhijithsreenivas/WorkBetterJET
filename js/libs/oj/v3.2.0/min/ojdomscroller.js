/**
 * Copyright (c) 2014, 2017, Oracle and/or its affiliates.
 * The Universal Permissive License (UPL), Version 1.0
 */
"use strict";
define(["ojs/ojcore","jquery"],function(a,g){a.Yf=function(a,b,d){d=d||{};this.p=b;this.Lj=g(a)[0];this.qB=d.fetchSize;this.qB=0<this.qB?this.qB:25;this.XB=d.maxCount;this.XB=0<this.XB?this.XB:500;this.Dq=0;this.Ska=d.success;this.GBa=d.error;this.Fy();this.Hx=d.fetchTrigger;if(null==this.Hx||isNaN(this.Hx))this.Hx=0;this.yHa=this.Lj.scrollTop;g(this.JN()).on("scroll.domscroller",function(){var a=this.Lj,b=this.bEa(a),a=a.scrollHeight-a.clientHeight;0<a&&this.JZ(b,a)}.bind(this))};a.Yf.prototype.JN=
function(){return this.Lj==document.body||this.Lj==document.documentElement?window:this.Lj};a.Yf.EPa=function(a,b){for(var d=0,e=b;e&&e!=a&&g.contains(a,e);)d+=e.offsetTop,e=e.offsetParent;return d};a.Yf.prototype.bEa=function(a){var b=this.Hx;return a==document.documentElement&&(void 0===this.Ila&&(this.Ila=this.yHa==a.scrollTop?!0:!1),this.Ila)?b+document.body.scrollTop:b+a.scrollTop};a.Yf.prototype.destroy=function(){this.cp();g(this.JN()).off("scroll.domscroller")};a.f.j("DomScroller.prototype.destroy",
{destroy:a.Yf.prototype.destroy});a.Yf.prototype.checkViewport=function(){return 0<this.Lj.clientHeight&&!this.Sya()?this.Ica():Promise.resolve(null)};a.f.j("DomScroller.prototype.checkViewport",{checkViewport:a.Yf.prototype.checkViewport});a.Yf.prototype.JZ=function(a,b){if(1>=b-a&&!this.YF){var d=this;this.Ica().then(function(a){null!=d.Ska&&d.Ska(a)},this.GBa)}};a.Yf.prototype.Sya=function(){var a=this.Lj;return a.scrollHeight>a.clientHeight+this.Hx?!0:!1};a.Yf.prototype.Ica=function(){if(this.YF)return this.YF;
var a=this.XB-this.Dq;if(0<a){var b=this.qB,d=this;a<this.qB&&(b=a);var e=this.RBa({pageSize:b});return this.YF=new Promise(function(b){e.then(function(e){d.YF=null;null!=e&&0<e.data.length&&(d.Dq=e.data.length+e.startIndex,a<d.qB&&(e.maxCount=d.XB,e.maxCountLimit=!0));b(e)})})}return Promise.resolve({maxCount:this.XB,maxCountLimit:!0})};a.Yf.prototype.RBa=function(a){a=a||{};var b=a.pageSize;this.Ek=this.Ek?this.Ek+b:b;if(-1==this.p.totalSize()||!this.Dg()||this.Dg()&&this.p.totalSize()>this.Ek){var d=
this;return new Promise(function(a,c){d.p.fetch({startIndex:d.Ek,pageSize:b}).then(function(b){a(b)},function(){c(null)})})}return Promise.resolve()};a.Yf.prototype.Ru=function(){this.Ek=null;this.Dq=0};a.Yf.prototype.WEa=function(a){this.Ek=a.startIndex;0<a.data.length&&(this.Dq=a.data.length+this.Ek)};a.Yf.prototype.cfa=function(c){return function(b){b=b||{};b=b.indexes;var d,e=b.length;for(d=0;d<e;d++){var f=b[d];void 0!==f&&0<this.Dq&&f<=this.Dq&&(c==a.ga.Y.ADD?this.Dq+=1:c==a.ga.Y.REMOVE&&(this.Dq-=
1))}}};a.Yf.prototype.Dg=function(){var a=this.p;return null!=a&&"actual"==a.totalSizeConfidence()?!0:!1};a.Yf.prototype.Fy=function(){var c=this.p;if(null!=c){this.cp();this.Mb=[];this.Mb.push({eventType:a.ga.Y.SORT,eventHandler:this.Ru.bind(this)});this.Mb.push({eventType:a.ga.Y.REFRESH,eventHandler:this.Ru.bind(this)});this.Mb.push({eventType:a.ga.Y.RESET,eventHandler:this.Ru.bind(this)});this.Mb.push({eventType:a.ga.Y.SYNC,eventHandler:this.WEa.bind(this)});this.Mb.push({eventType:a.ga.Y.ADD,
eventHandler:this.cfa(a.ga.Y.ADD).bind(this)});this.Mb.push({eventType:a.ga.Y.REMOVE,eventHandler:this.cfa(a.ga.Y.REMOVE).bind(this)});var b,d;for(b=0;b<this.Mb.length;b++)(d=c.on(this.Mb[b].eventType,this.Mb[b].eventHandler))&&(this.Mb[b].eventHandler=d)}};a.Yf.prototype.cp=function(){var a=this.p;if(null!=this.Mb&&null!=a){var b;for(b=0;b<this.Mb.length;b++)a.off(this.Mb[b].eventType,this.Mb[b].eventHandler)}}});