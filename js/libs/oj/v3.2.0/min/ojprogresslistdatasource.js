/**
 * Copyright (c) 2014, 2017, Oracle and/or its affiliates.
 * The Universal Permissive License (UPL), Version 1.0
 */
"use strict";
define(["ojs/ojcore","jquery","ojs/ojarraytabledatasource"],function(a,g){a.Xe=function(){};o_("ProgressItem",a.Xe,a);a.Xe.zE={QUEUED:"queued",LOADSTARTED:"loadstarted",ABORTED:"aborted",ERRORED:"errored",TIMEDOUT:"timedout",LOADED:"loaded"};o_("ProgressItem.Status",a.Xe.zE,a);a.Xe.Y={LOADSTART:"loadstart",PROGRESS:"progress",ABORT:"abort",ERROR:"error",LOAD:"load",TIMEOUT:"timeout",LOADEND:"loadend"};o_("ProgressItem.EventType",a.Xe.Y,a);a.nc=function(c,b){this.Ah=new a.Xa(c,b);a.nc.N.constructor.call(this,
c,b)};o_("ProgressListDataSource",a.nc,a);a.f.xa(a.nc,a.ga,"oj.ProgressListDataSource");a.nc.prototype.sortCriteria=null;a.f.j("ProgressListDataSource.prototype.sortCriteria",{sortCriteria:a.nc.prototype.sortCriteria});a.nc.prototype.Init=function(){this.Ah.Init();a.nc.N.Init.call(this);this.jja();this.sia=this.FGa.bind(this);this.uca=this.EGa.bind(this);this.mca=this.DGa.bind(this)};a.f.j("ProgressListDataSource.prototype.Init",{Init:a.nc.prototype.Init});a.nc.prototype.add=function(a,b){var d=this,
e=this.Ah.add(a,b);e.then(function(){d.txa(a)});return e};a.f.j("ProgressListDataSource.prototype.add",{add:a.nc.prototype.add});a.nc.prototype.at=function(a,b){return this.Ah.at(a,b)};a.f.j("ProgressListDataSource.prototype.at",{at:a.nc.prototype.at});a.nc.prototype.fetch=function(a){return this.Ah.fetch(a)};a.f.j("ProgressListDataSource.prototype.fetch",{fetch:a.nc.prototype.fetch});a.nc.prototype.get=function(a,b){return this.Ah.get(a,b)};a.f.j("ProgressListDataSource.prototype.get",{get:a.nc.prototype.get});
a.nc.prototype.getCapability=function(a){return this.Ah.getCapability(a)};a.f.j("ProgressListDataSource.prototype.getCapability",{getCapability:a.nc.prototype.getCapability});a.nc.prototype.remove=function(a,b){var d=this,e=this.Ah.remove(a,b);e.then(function(){d.hLa(a)});return e};a.f.j("ProgressListDataSource.prototype.remove",{remove:a.nc.prototype.remove});a.nc.prototype.sort=function(a){this.Ah.sortCriteria=this.sortCriteria;a=this.Ah.sort(a);this.sortCriteria=this.Ah.sortCriteria;return a};
a.f.j("ProgressListDataSource.prototype.sort",{sort:a.nc.prototype.sort});a.nc.prototype.totalSize=function(){return this.Ah.totalSize()};a.f.j("ProgressListDataSource.prototype.totalSize",{totalSize:a.nc.prototype.totalSize});a.nc.prototype.on=function(a,b){this.Ah.on(a,b)};a.f.j("ProgressListDataSource.prototype.on",{on:a.nc.prototype.on});a.nc.prototype.off=function(a,b){this.Ah.off(a,b)};a.f.j("ProgressListDataSource.prototype.off",{off:a.nc.prototype.off});a.nc.prototype.handleEvent=function(a,
b){return this.Ah.handleEvent(a,b)};a.f.j("ProgressListDataSource.prototype.handleEvent",{handleEvent:a.nc.prototype.handleEvent});a.nc.prototype.clear=function(a){if(!a||0==a.length)return this.Ah.reset(null,{vra:!0});for(var b=this,d={},e=0;e<a.length;e++)d[a[e]]=!0;return this.Ah.fetch({vra:!0}).then(function(a){a=a.data;for(var c,e=[],g=0;g<a.length;g++)c=a[g],d[c.status]&&e.push(c);return b.remove(e)})};a.f.j("ProgressListDataSource.prototype.clear",{clear:a.nc.prototype.clear});a.nc.prototype.txa=
function(a){var b,d;a instanceof Array||(a=[a]);for(b=0;b<a.length;b++)(d=a[b])&&this.wxa(d);this.ZP(null)};a.nc.prototype.hLa=function(a){var b,d;a instanceof Array||(a=[a]);for(b=0;b<a.length;b++)(d=a[b])&&this.jLa(d);this.ZP(null)};a.nc.prototype.FGa=function(a){var b=a.target;b&&a.lengthComputable&&this.ZP(b)};a.nc.prototype.DGa=function(){this.ola>=this.nla&&this.jja()};a.nc.prototype.EGa=function(a){if(a=a.target)this.ZP(a),this.vca++};a.nc.prototype.wxa=function(c){c.addEventListener(a.Xe.Y.PROGRESS,
this.sia,!1);c.addEventListener(a.Xe.Y.ERROR,this.uca,!1);c.addEventListener(a.Xe.Y.LOAD,this.mca,!1)};a.nc.prototype.jLa=function(c){c.removeEventListener(a.Xe.Y.PROGRESS,this.sia,!1);c.removeEventListener(a.Xe.Y.ERROR,this.uca,!1);c.removeEventListener(a.Xe.Y.LOAD,this.mca,!1)};a.nc.prototype.jja=function(){this.ola=this.nla=this.vca=0};a.nc.prototype.ZP=function(a){var b,d=0,e=0,f=!a,g=this;this.Ah.fetch({vra:!0}).then(function(k){b=k.data;for(var l=0;l<b.length;l++)k=b[l],f||k.item!==a.item||
(f=!0),k.loaded&&(e+=k.loaded),d+=k.total;f&&(g.ola=e,g.nla=d,g.dCa(e,d))})};a.nc.prototype.dCa=function(a,b){var d=g.Event("overallProgress",{lengthComputable:!0,total:b,loaded:a,error:this.vca,target:this});this.Ah.handleEvent("overallProgress",d)}});